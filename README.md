ПЕРЕПИСАТЬ

## XLSX-TEMPLATER 

Шаблонизатор для заполнения excel файлов данными из (?)

### Gratitude
* github.com/qax-os/excelize
* github.com/skip2/go-qrcode

## Placeholders

Для заполнения документа необходимо в нем расставить плейсхолдеры в местах заполнения, по которым программа найдет соответствующие данные в json файле

Плейсхолдер - это специально построенная строка, с помощью которой шаблонизатор понимает куда и что ему необходимо вставить

1. плейсхолдер состоит из ключей, разделенных знаком `:`
2. ключи могут быть нескольких видов:
   * field name
   * array 
   * qr code 
   * image
3. плейсхолдер находится между фигурными скобками {}

Ключи:

1. `field name` - строка типа [a-zA-Z0-9_]+,ключ необходимый для спуска по дереву json, представляет собой имя полей json, по последнему ключу должно лежать значение
2. `array` - служит для указания генерации таблицы из массива, **данный ключ находится в конце плейсхолдера**, плейсхолдер располагается в левом верхнем углу генерируемой таблицы, на следующей строке расположена шапка таблицы, элементы шапки это плейсхолдеры для получения данных из элементов массива, они указывают какие элементы куда всталять, показывают размеры таблицы и задают стили элементов таблицы. Начало шапки таблицы располагается под соответсвующим плейсхолдером с ключом array
**!!!строка с плейсхолдером `array` и строка с шапкой таблицы буду удалены!!!**
3. `qr code` - строка типа qr_code_[0-9]+, указывает, что нужно вставить массив qr кодов начиная с позиции ключа,  **данный ключ находится в конце плейсхолдера**. Данные берутся из json файла, название поля должно соответствовать ключу. Данные должны быть в представлены как массив строк.
4. `image` - строка типа image_[0-9]+, указывает, что нужно вставить `.png` изображение на данное место, данные для изображения лежат в json по плейсхолдеру

Если программа не находит данные в json по плейсхолдеру и `VALUE_ARE_REQUIRED`, при запуске программы, выставлен в `false`, то на месте плейсхолдер заменяется на пустое значение, если `VALUE_ARE_REQUIRED`, при запуске программы, выставлен в `true`, программа возращает ошибку.

Пример:

шаблон

![шаблон](images/template.png)

данные для заполнения

```json
{
    "field_name_0": "value_field_name_0",
    "field_name_1":{
      "field_name_1": "value_field_name_1_1",
      "array_1":[
        {
          "1":1.0,
          "2_0":2.0,
          "3_0":3.0
        },
        {
          "1":1.1,
          "2_0":2.1,
          "3_0":3.1
        },
        {
          "1":1.2,
          "2_0":2.2,
          "3_0":3.2
        }
      ],
      "qr_code_1":[
        "https://t.me/geoirb",
        "https://github.com/geoirb"
      ]
    },
    "qr_code_0":[
        "https://t.me/geoirb",
        "https://github.com/geoirb"
    ],
    "image_0":"data:image/png;base64,iVBORw0KGg...",
}
```
результат

![результат](images/result.png)
